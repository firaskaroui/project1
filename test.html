<!DOCTYPE html>
<html>
<head>
    <title>Excel Upload</title>
    <style>
        table, th, td {
            border: 1px solid gray;
            border-collapse: collapse;
            padding: 6px;
        }
    </style>
</head>
<body>
    <h2>Upload Excel File</h2>

    {% if error %}<p style="color:red;">{{ error }}</p>{% endif %}

    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.as_p }}

        {% if sheet_names %}
            <label for="sheet_name">Select Sheet:</label>
            <select name="sheet_name" onchange="this.form.submit()">
                {% for sheet in sheet_names %}
                    <option value="{{ sheet }}" {% if sheet == selected_sheet %}selected{% endif %}>
                        {{ sheet }}
                    </option>
                {% endfor %}
            </select>
        {% endif %}

        {% if not sheet_names %}
            <button type="submit">Upload</button>
        {% endif %}
    </form>

    {% if sheet_data %}
        <h3>Data from "{{ selected_sheet }}"</h3>
        {{ sheet_data|safe }}
    {% endif %}
</body>
</html>